<?php
 if ( ! class_exists( 'Redux_ThemeCheck' ) ) { class Redux_ThemeCheck { protected $version = '1.0.0'; protected static $instance = null; protected static $redux = null; protected static $redux_details = null; protected $slug = 'redux_themecheck'; private function __construct() { if ( ! class_exists( 'ThemeCheckMain' ) ) { return; } add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_styles' ) ); add_action( 'admin_enqueue_scripts', array( $this, 'enqueue_admin_scripts' ) ); add_action( 'themecheck_checks_loaded', array( $this, 'disable_checks' ) ); add_action( 'themecheck_checks_loaded', array( $this, 'add_checks' ) ); } public static function get_instance() { if ( null == self::$instance ) { self::$instance = new self; } return self::$instance; } public static function get_redux_instance() { if ( null == self::$redux ) { self::$redux = new ReduxFramework(); self::$redux->init(); } return self::$redux; } public static function get_redux_details( $php_files = array() ) { if ( self::$redux_details === null ) { foreach ( $php_files as $php_key => $phpfile ) { if ( strpos( $phpfile, 'class' . ' ReduxFramework {' ) !== false ) { self::$redux_details = array( 'filename' => strtolower( basename( $php_key ) ), 'path' => $php_key, ); self::$redux_details['dir'] = str_replace( basename( $php_key ), '', $php_key ); self::$redux_details['parent_dir'] = str_replace( basename( self::$redux_details['dir'] ) . '/', '', self::$redux_details['dir'] ); } } } if ( self::$redux_details === null ) { self::$redux_details = false; } return self::$redux_details; } function disable_checks() { global $themechecks; } function add_checks() { global $themechecks; $dir = 'checks'; foreach ( glob( dirname( __FILE__ ) . '/' . $dir . '/*.php' ) as $file ) { require_once $file; } } public function enqueue_admin_styles() { $screen = get_current_screen(); if ( 'appearance_page_themecheck' == $screen->id ) { wp_enqueue_style( $this->slug . '-admin-styles', ReduxFramework::$_url . 'inc/themecheck/css/admin.css', array(), $this->version ); } } public function enqueue_admin_scripts() { $screen = get_current_screen(); if ( 'appearance_page_themecheck' == $screen->id ) { wp_enqueue_script( $this->slug . '-admin-script', ReduxFramework::$_url . 'inc/themecheck/js/admin.js', array( 'jquery' ), $this->version ); if ( ! isset( $_POST['themename'] ) ) { $intro = ''; $intro .= '<h2>Redux Theme-Check</h2>'; $intro .= '<p>Extra checks for Redux to ensure you\'re ready for marketplace submission to marketplaces.</p>'; $redux_check_intro['text'] = $intro; wp_localize_script( $this->slug . '-admin-script', 'redux_check_intro', $redux_check_intro ); } } } } Redux_ThemeCheck::get_instance(); }
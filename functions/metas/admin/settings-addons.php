<?php
 class acf_settings_addons { var $view; function __construct() { add_action( 'admin_menu', array( $this, 'admin_menu' ) ); } function admin_menu() { if( !acf_get_setting('show_admin') ) { return; } $page = add_submenu_page('edit.php?post_type=acf-field-group', __('Add-ons','acf'), __('Add-ons','acf'), acf_get_setting('capability'),'acf-settings-addons', array($this,'html') ); add_action('load-' . $page, array($this,'load')); } function load() { $this->view = array( 'json' => array(), ); $request = wp_remote_post( 'http://assets.advancedcustomfields.com/add-ons/add-ons.json' ); if( is_wp_error($request) || wp_remote_retrieve_response_code($request) != 200) { acf_add_admin_notice(__('<b>Error</b>. Could not load add-ons list', 'acf'), 'error'); } else { $this->view['json'] = json_decode( $request['body'], true ); } } function html() { acf_get_view('settings-addons', $this->view); } } new acf_settings_addons(); ?>

<?php
 if( ! class_exists('acf_field_textarea') ) : class acf_field_textarea extends acf_field { function __construct() { $this->name = 'textarea'; $this->label = __("Text Area",'acf'); $this->defaults = array( 'default_value' => '', 'new_lines' => '', 'maxlength' => '', 'placeholder' => '', 'readonly' => 0, 'disabled' => 0, 'rows' => '' ); parent::__construct(); } function render_field( $field ) { $o = array( 'id', 'class', 'name', 'placeholder', 'rows' ); $s = array( 'readonly', 'disabled' ); $e = ''; if( $field['maxlength'] !== '' ) { $o[] = 'maxlength'; } if( empty($field['rows']) ) { $field['rows'] = 8; } $atts = array(); foreach( $o as $k ) { $atts[ $k ] = $field[ $k ]; } foreach( $s as $k ) { if( $field[ $k ] ) { $atts[ $k ] = $k; } } $e .= '<textarea ' . acf_esc_attr( $atts ) . ' >'; $e .= esc_textarea( $field['value'] ); $e .= '</textarea>'; echo $e; } function render_field_settings( $field ) { if( empty($field['ID']) ) { $field['new_lines'] = 'wpautop'; } acf_render_field_setting( $field, array( 'label' => __('Default Value','acf'), 'instructions' => __('Appears when creating a new post','acf'), 'type' => 'textarea', 'name' => 'default_value', )); acf_render_field_setting( $field, array( 'label' => __('Placeholder Text','acf'), 'instructions' => __('Appears within the input','acf'), 'type' => 'text', 'name' => 'placeholder', )); acf_render_field_setting( $field, array( 'label' => __('Character Limit','acf'), 'instructions' => __('Leave blank for no limit','acf'), 'type' => 'number', 'name' => 'maxlength', )); acf_render_field_setting( $field, array( 'label' => __('Rows','acf'), 'instructions' => __('Sets the textarea height','acf'), 'type' => 'number', 'name' => 'rows', 'placeholder' => 8 )); acf_render_field_setting( $field, array( 'label' => __('New Lines','acf'), 'instructions' => __('Controls how new lines are rendered','acf'), 'type' => 'select', 'name' => 'new_lines', 'choices' => array( 'wpautop' => __("Automatically add paragraphs",'acf'), 'br' => __("Automatically add &lt;br&gt;",'acf'), '' => __("No Formatting",'acf') ) )); } function format_value( $value, $post_id, $field ) { if( empty($value) || !is_string($value) ) { return $value; } if( $field['new_lines'] == 'wpautop' ) { $value = wpautop($value); } elseif( $field['new_lines'] == 'br' ) { $value = nl2br($value); } return $value; } } new acf_field_textarea(); endif; ?>
